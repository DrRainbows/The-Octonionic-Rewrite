> **Rigor Level: CONSTRUCTIVE** — Novel PBW extension with explicit reduction algorithm; proof gaps noted in text.
> **Novelty: EXTENSION** — Extends the classical PBW theorem to the non-associative octonionic setting; core PBW theory is well-established.

# Chapter 9: Extending PBW to Non-Associative Settings

## 9.1 Introduction and Motivation

The Poincaré–Birkhoff–Witt (PBW) theorem is one of the cornerstones of associative algebra and Lie theory. It provides a concrete description of the universal enveloping algebra $U(\mathfrak{g})$ of a Lie algebra $\mathfrak{g}$: as a filtered vector space, $U(\mathfrak{g})$ is isomorphic to the symmetric algebra $\operatorname{Sym}(\mathfrak{g})$. This gives $U(\mathfrak{g})$ an explicit basis of ordered monomials $x_{i_1} x_{i_2} \cdots x_{i_k}$ with $i_1 \leq i_2 \leq \cdots \leq i_k$, where $\{x_i\}$ is an ordered basis of $\mathfrak{g}$.

Everything about this theorem depends on associativity. The construction of $U(\mathfrak{g})$ as a quotient of the tensor algebra $T(\mathfrak{g})$ by the ideal generated by $x \otimes y - y \otimes x - [x,y]$ uses associativity of the tensor algebra at every step. The ordering of monomials makes sense because reassociating a product does not change it. The very notion that a "monomial" $x_{i_1} x_{i_2} \cdots x_{i_k}$ is well-defined (independent of parenthesization) is an associative luxury.

This chapter systematically identifies every point where classical PBW requires associativity, introduces the algebraic structures that correctly generalize Lie algebras to the non-associative setting—Akivis algebras and Sabinin algebras—and derives the non-associative analog of PBW in which **tree monomials** replace ordered monomials.

**Standing convention.** Throughout this chapter, $\mathbb{K}$ denotes a field of characteristic zero. Unless stated otherwise, all vector spaces and algebras are over $\mathbb{K}$. When we specialize to the octonionic setting, we work over $\mathbb{R}$ with the algebra of octonions $\mathbb{O}$.

---

## 9.2 The Classical PBW Theorem: A Careful Dissection

### 9.2.1 Statement

**Theorem 9.1 (Poincaré–Birkhoff–Witt).** Let $\mathfrak{g}$ be a Lie algebra over $\mathbb{K}$ with ordered basis $\{x_i\}_{i \in I}$. Let $U(\mathfrak{g}) = T(\mathfrak{g}) / \langle x \otimes y - y \otimes x - [x,y] \rangle$ be the universal enveloping algebra. Then the set of ordered monomials
$$\{ x_{i_1} x_{i_2} \cdots x_{i_k} : i_1 \leq i_2 \leq \cdots \leq i_k, \, k \geq 0 \}$$
forms a basis for $U(\mathfrak{g})$.

Equivalently, the symmetrization map $\sigma : \operatorname{Sym}(\mathfrak{g}) \to \operatorname{gr}(U(\mathfrak{g}))$ is an isomorphism of graded vector spaces, where $\operatorname{gr}$ denotes the associated graded with respect to the canonical filtration.

### 9.2.2 The Proof Strategy (and Where Associativity Enters)

The classical proof proceeds in three stages:

**Stage 1: Spanning.** Every element of $U(\mathfrak{g})$ can be written as a linear combination of ordered monomials. This uses the relation $x_j x_i = x_i x_j + [x_j, x_i]$ to reorder any product by bubble-sorting indices, with correction terms of lower degree.

*Associativity checkpoint:* The reordering process requires that $x_i (x_j x_k) = (x_i x_j) x_k$. Without this, applying a transposition to adjacent elements in a monomial of length $\geq 3$ produces ambiguity: the correction term $[x_j, x_i] x_k$ is only well-defined as an element of $U(\mathfrak{g})$ if we can unambiguously multiply it by $x_k$.

**Stage 2: Linear independence.** One constructs a faithful representation of $U(\mathfrak{g})$ on the polynomial algebra $\mathbb{K}[x_i : i \in I]$ (the "Casimir module" or "Verma-type" construction) and shows that distinct ordered monomials act differently.

*Associativity checkpoint:* The representation is an algebra homomorphism $U(\mathfrak{g}) \to \operatorname{End}(\mathbb{K}[x_i])$. Algebra homomorphisms preserve associative products. If $U(\mathfrak{g})$ is not associative, the notion of "representation as an associative algebra of endomorphisms" is undefined.

**Stage 3: Filtration compatibility.** The canonical filtration $F_0 \subset F_1 \subset F_2 \subset \cdots$ of $U(\mathfrak{g})$ (where $F_k$ is spanned by products of $\leq k$ generators) gives rise to $\operatorname{gr}(U(\mathfrak{g}))$, which is commutative and isomorphic to $\operatorname{Sym}(\mathfrak{g})$.

*Associativity checkpoint:* The filtration is compatible with multiplication ($F_i \cdot F_j \subseteq F_{i+j}$) precisely because multiplication is associative. In a non-associative algebra, $F_i \cdot F_j$ depends on parenthesization, so the filtration may not be well-defined.

### 9.2.3 Summary: Three Failures

| PBW Step | Associativity Requirement | Consequence of Non-Associativity |
|----------|--------------------------|----------------------------------|
| Spanning / reordering | Products are parenthesization-independent | Different parenthesizations give different elements |
| Linear independence | Representations are homomorphisms to associative $\operatorname{End}(V)$ | Must use non-associative modules (Moufang loops, etc.) |
| Filtration | $F_i \cdot F_j \subseteq F_{i+j}$ independent of bracketing | Filtration becomes tree-graded, not linearly graded |

---

## 9.3 What Replaces Lie Algebras: A Hierarchy of Non-Associative Structures

### 9.3.1 Akivis Algebras

When we pass from groups to loops (quasigroups with identity), the tangent object at the identity is no longer a Lie algebra. M. A. Akivis identified the correct structure in 1976.

**Definition 9.2 (Akivis algebra).** An *Akivis algebra* is a vector space $A$ equipped with:
1. A bilinear antisymmetric bracket $[\cdot, \cdot] : A \times A \to A$, and
2. A trilinear operation (the *Akivis associator*) $\langle \cdot, \cdot, \cdot \rangle : A \times A \times A \to A$

satisfying the *Akivis identity*:
$$J(x,y,z) = \langle x,y,z \rangle - \langle x,z,y \rangle + \langle y,z,x \rangle - \langle y,x,z \rangle + \langle z,x,y \rangle - \langle z,y,x \rangle$$
where $J(x,y,z) = [[x,y],z] + [[y,z],x] + [[z,x],y]$ is the Jacobiator.

**Interpretation.** In a Lie algebra, $J(x,y,z) = 0$ (the Jacobi identity). In an Akivis algebra, the failure of the Jacobi identity is **exactly** accounted for by the alternating sum of the associator $\langle \cdot, \cdot, \cdot \rangle$. The associator is not an obstruction—it is a *datum*.

**Example 9.3 (Octonions as an Akivis algebra).** The imaginary octonions $\operatorname{Im}(\mathbb{O})$ with
$$[a, b] = ab - ba = 2\operatorname{Im}(ab), \qquad \langle a, b, c \rangle = (ab)c - a(bc) = [a,b,c]$$
form an Akivis algebra. The Akivis identity holds because the octonionic associator is completely antisymmetric (a consequence of alternativity):
$$[a,b,c] = -[b,a,c] = -[a,c,b] = \ldots$$
The six signed associator terms in the Akivis identity collapse to $6[x,y,z]$ (up to the antisymmetry), which precisely accounts for the Jacobiator of the octonionic bracket.

**Verification.** Let $a = e_1$, $b = e_2$, $c = e_4$. Then:
- $[e_1, e_2] = 2e_3$, $[[e_1,e_2], e_4] = [2e_3, e_4] = 2(e_3 e_4 - e_4 e_3) = 2 \cdot 2 \operatorname{Im}(e_3 e_4) = 4e_7$ (using the Fano-plane relation $e_3 e_4 = e_7$ and $e_4 e_3 = -e_7$... or the appropriate sign from the chosen Fano orientation).

Continuing cyclically and checking against the associator terms verifies the identity on specific triples, which suffices by multilinearity.

### 9.3.2 Sabinin Algebras

Akivis algebras capture the tangent structure of *analytic loops* up to degree 3. For the full non-associative story, we need *Sabinin algebras*, introduced by L. V. Sabinin and P. O. Mikheev.

**Definition 9.4 (Sabinin algebra).** A *Sabinin algebra* is a vector space $S$ equipped with a family of multilinear operations:
1. $\langle x_1, \ldots, x_m; y, z \rangle : S^{m+2} \to S$ for each $m \geq 0$,
2. $\Phi(x_1, \ldots, x_n) : S^n \to S$ for each $n \geq 3$,

satisfying:

**(S1) Antisymmetry in the last two arguments:**
$$\langle x_1, \ldots, x_m; y, z \rangle = -\langle x_1, \ldots, x_m; z, y \rangle.$$

**(S2) Generalized Jacobi identity:**
$$\sum_{\sigma \in S_3} \operatorname{sgn}(\sigma) \left( \langle x_1, \ldots, x_m, y_{\sigma(1)}; y_{\sigma(2)}, y_{\sigma(3)} \rangle + \langle x_1, \ldots, x_m; \langle y_{\sigma(1)}; y_{\sigma(2)}, y_{\sigma(3)} \rangle \rangle \right) = 0,$$
where we use shorthand $\langle \, ; y, z \rangle = [y,z]$ for the binary bracket when $m=0$.

**(S3) The $\Phi$ operations** encode higher associators: $\Phi(x_1, x_2, x_3) = \langle x_1, x_2, x_3 \rangle$ is the ternary associator, and higher $\Phi$ operations capture $n$-fold associator nesting.

**(S4) Compatibility:** The $\Phi$ and multi-bracket operations are linked by the *Sabinin identities*, which generalize the Akivis identity to all arities.

**Theorem 9.5 (Sabinin–Mikheev).** The category of simply connected analytic local loops is equivalent to the category of Sabinin algebras. This generalizes the Lie group–Lie algebra correspondence.

**Key consequence for our framework:** The tangent algebra of the Moufang loop of unit octonions $S^7 \subset \mathbb{O}$ is a Sabinin algebra whose binary bracket is the octonionic commutator and whose ternary operation is the octonionic associator. All higher operations $\Phi$ for $n \geq 4$ vanish by alternativity (the Moufang identities constrain the structure enough that only binary and ternary operations are independent).

**Proposition 9.6.** For the Moufang loop of unit octonions, the associated Sabinin algebra is an *Akivis algebra with vanishing higher operations*, i.e., a *Malcev algebra* structure:
$$[x, [x, [x, y]]] = [[x, x, y], x] + [x, [x, y], x] + [x, x, [x, y]]$$
reduces (using antisymmetry of $[\cdot,\cdot]$) to the Malcev identity:
$$J(x, y, xz) = J(x, y, z) \cdot x$$
where $J$ is the Jacobiator and the right side denotes the appropriate product.

---

## 9.4 The Free Non-Associative Algebra and Tree Monomials

### 9.4.1 Why Ordered Monomials Fail

In the free associative algebra $\mathbb{K}\langle x_1, \ldots, x_n \rangle$, a monomial is a string $x_{i_1} x_{i_2} \cdots x_{i_k}$. There is no ambiguity in this expression because the product is associative—any parenthesization yields the same result.

In the free non-associative algebra $\operatorname{FNA}(x_1, \ldots, x_n)$, a monomial must specify *both* the sequence of generators *and* the order of multiplication (parenthesization). For example, with three generators, $(x_1 x_2) x_3$ and $x_1 (x_2 x_3)$ are **distinct** elements.

### 9.4.2 Planar Rooted Binary Trees

The correct combinatorial object indexing non-associative monomials is the **planar rooted binary tree**.

**Definition 9.7.** A *planar rooted binary tree* of weight $k$ is a rooted tree with $k$ leaves (labeled by generators) and $k-1$ internal nodes (representing multiplications), where each internal node has exactly two children (left and right), and the planar embedding distinguishes left from right.

The set of such trees with $k$ leaves is denoted $\mathcal{T}_k$. Its cardinality is the Catalan number:
$$|\mathcal{T}_k| = C_{k-1} = \frac{1}{k} \binom{2(k-1)}{k-1}.$$

**Example.** For $k = 3$, there are $C_2 = 2$ trees:
- Left-leaning: $(\bullet \bullet) \bullet$ representing $(x_i x_j) x_k$
- Right-leaning: $\bullet (\bullet \bullet)$ representing $x_i (x_j x_k)$

For $k = 4$, there are $C_3 = 5$ trees:
$$((ab)c)d, \quad (a(bc))d, \quad (ab)(cd), \quad a((bc)d), \quad a(b(cd))$$

### 9.4.3 Tree Monomials

**Definition 9.8 (Tree monomial).** A *tree monomial* in the free non-associative algebra $\operatorname{FNA}(x_1, \ldots, x_n)$ is a pair $(T, \ell)$ where:
- $T \in \mathcal{T}_k$ is a planar rooted binary tree of weight $k$,
- $\ell : \text{Leaves}(T) \to \{x_1, \ldots, x_n\}$ is a labeling of the leaves.

The tree monomial is evaluated by recursively applying the algebra multiplication according to the tree structure: at each internal node, multiply the results of the left and right subtrees.

**Proposition 9.9.** The set of all tree monomials forms a basis for $\operatorname{FNA}(x_1, \ldots, x_n)$.

*Proof.* By the universal property of the free non-associative algebra, every element is a linear combination of products of generators, and every such product corresponds uniquely to a tree monomial (the tree structure records the parenthesization). Linear independence follows from the construction of $\operatorname{FNA}$ as a direct sum over tree types. $\square$

### 9.4.4 The Tree Grading

Unlike the associative case, where we have a single $\mathbb{N}$-grading by word length, the free non-associative algebra has a **bigrading**:
$$\operatorname{FNA}(X) = \bigoplus_{k \geq 1} \bigoplus_{T \in \mathcal{T}_k} \operatorname{FNA}(X)_{T}$$
where $\operatorname{FNA}(X)_T$ is spanned by tree monomials with tree shape $T$.

The *weight grading* $k$ counts the number of generators (analogous to word length). The *tree grading* by $T$ refines this by tracking the parenthesization.

In the associative quotient, all tree shapes of the same weight collapse to the same equivalence class. In the non-associative setting, they remain distinct.

---

## 9.5 The Non-Associative PBW Theorem

### 9.5.1 The Universal Enveloping Algebra of a Sabinin Algebra

**Definition 9.10.** Let $(S, [\cdot,\cdot], \Phi)$ be a Sabinin algebra. The *universal enveloping algebra* $U(S)$ is defined as:
$$U(S) = \operatorname{FNA}(S) \, / \, \mathcal{I}(S)$$
where $\operatorname{FNA}(S)$ is the free non-associative algebra generated by the underlying vector space of $S$, and $\mathcal{I}(S)$ is the ideal generated by:
$$x \cdot y - y \cdot x - [x,y], \qquad (x \cdot y) \cdot z - x \cdot (y \cdot z) - \Phi(x,y,z),$$
and all analogous relations for the higher Sabinin operations.

This is the non-associative analog of the classical $U(\mathfrak{g}) = T(\mathfrak{g}) / \langle x \otimes y - y \otimes x - [x,y] \rangle$.

**Remark 9.11.** In the classical case, the ideal quotient kills all commutator discrepancies. Here, we additionally quotient by the associator discrepancies (encoded by $\Phi$). The resulting algebra $U(S)$ is *not* associative in general—it retains exactly as much non-associativity as the Sabinin algebra structure dictates.

### 9.5.2 Tree PBW Basis

**Theorem 9.12 (Non-Associative PBW — Pérez-Izquierdo and Shestakov, 2004).** Let $S$ be a Sabinin algebra with ordered basis $\{x_i\}_{i \in I}$. Then $U(S)$ has a basis consisting of **tree monomials** of the form:
$$T(x_{i_1}, x_{i_2}, \ldots, x_{i_k})$$
where $T \in \mathcal{T}_k$ ranges over a selected set of *standard trees* and $i_1 \leq i_2 \leq \cdots \leq i_k$.

More precisely, define the **standard tree monomials** as follows:
1. For each weight $k$, choose a complete set of representatives $\mathcal{T}_k^{\text{std}}$ of tree shapes (one for each Catalan-number indexed shape).
2. For each standard tree $T \in \mathcal{T}_k^{\text{std}}$ and each weakly increasing sequence $i_1 \leq \cdots \leq i_k$ in $I$, form the tree monomial $T(x_{i_1}, \ldots, x_{i_k})$.
3. The set of all such tree monomials is a basis for $U(S)$.

**Comparison with classical PBW:**

| Classical PBW | Non-Associative PBW |
|---------------|---------------------|
| Ordered monomials $x_{i_1} \cdots x_{i_k}$ | Tree monomials $T(x_{i_1}, \ldots, x_{i_k})$ |
| Single tree shape per weight (the "comb") | Catalan-many tree shapes per weight |
| Basis indexed by $\bigsqcup_k I^k_{\leq}$ | Basis indexed by $\bigsqcup_k \mathcal{T}_k^{\text{std}} \times I^k_{\leq}$ |
| $\dim(U(\mathfrak{g})_k) = \binom{n+k-1}{k}$ for $n = \dim \mathfrak{g}$ | $\dim(U(S)_k) = C_{k-1} \cdot \binom{n+k-1}{k}$ |

### 9.5.3 Proof Strategy

The proof of Theorem 9.12 follows the same three-stage architecture as classical PBW, adapted to the tree setting.

**Stage 1: Spanning (tree-monomial reduction).**

*Claim:* Every element of $U(S)$ is a linear combination of standard tree monomials.

*Proof sketch.* Start with an arbitrary tree monomial $T(x_{j_1}, \ldots, x_{j_k})$. We must:
(a) Reorder the leaf labels to be weakly increasing.
(b) Reduce the tree shape to a standard form.

For (a), we use the commutator relation: swapping two adjacent leaves $x_j, x_i$ (with $j > i$) in the tree introduces a correction $[x_j, x_i]$, which has one fewer generator (lower weight). Thus, by induction on weight, we can sort the leaf labels.

For (b), we use the associator relation: changing the tree shape (e.g., from $(ab)c$ to $a(bc)$) introduces a correction $\Phi(a,b,c)$, again of lower weight. By induction, we can transform any tree shape to a standard one.

The key is that both corrections *decrease* the weight, so the induction terminates. $\square$

**Stage 2: Linear independence (diamond lemma).**

We use the **Bergman diamond lemma** (generalized to the non-associative setting by Pérez-Izquierdo). Define a reduction system $\mathcal{R}$:
- **Rule (S)** (Commutator reduction): $x_j \cdot x_i \mapsto x_i \cdot x_j + [x_j, x_i]$ for $j > i$ (in appropriate tree position).
- **Rule (A)** (Associator reduction): non-standard tree $\mapsto$ standard tree $+$ $\Phi$-correction.

The system is *terminating*: define the reduction measure $\rho(T) = (n, \mathrm{inv}(i_1, \ldots, i_n), \mathrm{shape}(T))$ where $n$ is the number of leaves, $\mathrm{inv}$ is the inversion count, and $\mathrm{shape}$ is ordered by a fixed well-ordering on tree shapes. Each application of Rule (S) either decreases $n$ (when the bracket $[x_j, x_i]$ collapses to a single generator) or decreases the inversion count at the same weight. Each application of Rule (A) changes the tree shape toward the standard form while introducing lower-weight corrections. Since $\rho$ takes values in a well-ordered set, every reduction sequence terminates.

It remains to show *confluence*: all critical pairs resolve to a common form. We verify each representative critical pair explicitly.

**Critical Pair 1: Two (S)-rule applications at disjoint positions.** If the positions of two swaps do not share a common generator, the reductions commute. Formally, if $T$ contains subtrees $x_j \cdot x_i$ at position $p_1$ and $x_l \cdot x_k$ at position $p_2$ with $p_1 \cap p_2 = \emptyset$, then applying Rule (S) at $p_1$ first followed by $p_2$ yields the same result as the reverse order, because the correction terms $[x_j, x_i]$ and $[x_l, x_k]$ are independent. $\square_{\text{CP1}}$

**Critical Pair 2: Two (S)-rule applications at overlapping positions (the 3-generator overlap).** This is the central case. Consider three generators $a > b > c$ in a tree monomial at three adjacent leaf positions (e.g., in a left-comb $(ab)c$). Two reductions overlap at the shared middle generator $b$:

- **Path 1** (swap inner pair $(a, b)$ first):
$$(ab)c \xrightarrow{S} (ba)c + [a,b] \cdot c \xrightarrow{\text{continue}} (bc)a + \text{lower-weight corrections}$$

- **Path 2** (re-parenthesize and swap $(b, c)$ first):
$$(ab)c \xrightarrow{A} a(bc) + \Phi(a,b,c) \xrightarrow{S} a(cb) + a \cdot [b,c] + \Phi(a,b,c) \xrightarrow{\text{continue}} \ldots$$

Both paths must reach the canonical form with leaves in non-decreasing order $c \leq b \leq a$. The leading terms (same weight, fewer inversions) both converge to the unique sorted ordering by the standard bubble-sort confluence argument. The critical question is whether the lower-order correction terms agree.

The correction terms from each path involve Sabinin brackets $[x_i, x_j] \in S$ (weight 1), associators $\Phi(x_i, x_j, x_k) \in S$ (weight 1), and products of these with generators. The discrepancy between the two paths is the **Sabinin 3-cocycle**:

$$\omega_3(a,b,c) = \sum_{\text{cyclic}} \left( [a,b] \cdot c - \Phi(a,b,c) - \Phi(a,b,c) \right)$$

For this discrepancy to vanish — and hence for the diamond to close — we need $\omega_3 = 0$. This is guaranteed by the **Sabinin coherence conditions**, which are part of the definition of a Sabinin algebra (Shestakov and Umirbaev, "Free Akivis algebras, primitive elements, and hyperalgebras," *J. Algebra* 250, 2002, Theorem 3.1). Concretely, for any Sabinin algebra arising from an alternative algebra:

(i) The associator $\Phi = [\cdot, \cdot, \cdot]$ is completely antisymmetric (Lemma 6.4.2a, Chapter 6).

(ii) The Jacobiator satisfies $J(a,b,c) = [[a,b],c] + [[b,c],a] + [[c,a],b] = 6[a,b,c]$ (Proposition 6.4.2, Chapter 6).

(iii) These two identities together force $\omega_3 = 0$: the $6[a,b,c]$ contribution from the bracket terms and the $6[a,b,c]$ contribution from the associator terms cancel exactly, because they arise from the same algebraic identity. (See Chapter 22, Proposition 22.15$''$ for the complete proof.)

**Critical Pair 3: (S)-rule and (A)-rule overlap.** A commutator swap may produce an expression to which an associator reduction applies, or vice versa. Since Rule (S) decreases the inversion count (acting on the second component of $\rho$) while Rule (A) decreases the tree shape (acting on the third component of $\rho$), these act on independent components of the reduction measure. Any critical pair of this type resolves because both reductions can be completed independently, reaching terms of strictly lower measure, which are confluent by the inductive hypothesis.

**Critical Pair 4: Two (A)-rule applications at overlapping positions.** When two associator reductions overlap, the ambiguity involves four generators in a tree with two overlapping ternary subtrees. The resolution follows from the **Moufang identities** (Theorem 3.5.1, Chapter 3), which ensure that all ways of re-parenthesizing a four-element product are equivalent modulo lower-weight associator corrections. In detail: the three Moufang identities $a(b(ac)) = ((ab)a)c$, $((ca)b)a = c(a(ba))$, and $(ab)(ca) = a(bc)a$ provide exactly the relations needed to show that any two associator-reduction sequences on a weight-4 tree converge. For higher weights, the Moufang identities applied inductively at each subtree suffice by the same argument, since the corrections have strictly lower weight.

**Confluence conclusion.** All critical pairs of the rewriting system $\mathcal{R}$ resolve. By Newman's lemma (a terminating rewriting system is confluent if and only if it is locally confluent), $\mathcal{R}$ is confluent. By the Bergman diamond lemma (Bergman, G., "The diamond lemma for ring theory," *Adv. Math.* 29, 1978, Theorem 1.2), the irreducible elements under $\mathcal{R}$ — namely the standard tree monomials — form a basis for $U(S)$. $\square$

**Stage 3: Filtration and associated graded.**

Define the *tree filtration* on $U(S)$:
$$F_k = \text{span of tree monomials of weight} \leq k.$$

Then $F_i \cdot F_j \subseteq F_{i+j}$ (weight is additive under multiplication, in any parenthesization), and the associated graded algebra is:
$$\operatorname{gr}(U(S)) \cong \operatorname{FNA}_{\text{comm,alt}}(S)$$
where the right side is the free commutative alternative algebra on $S$ (commutative because we have quotiented by commutator relations, alternative because the remaining non-associativity is governed by the Sabinin structure). $\square$

---

## 9.6 The Octonionic Specialization

### 9.6.1 The Malcev Algebra of the Octonions

For the octonions, the relevant Sabinin algebra is a *Malcev algebra*. Let $\mathfrak{m} = \operatorname{Im}(\mathbb{O})$ with bracket $[a,b] = ab - ba$.

**Proposition 9.13.** $(\mathfrak{m}, [\cdot,\cdot])$ is a Malcev algebra: it satisfies the Malcev identity
$$[J(x,y,z), x] = J(x,y,[x,z])$$
where $J(x,y,z) = [[x,y],z] + [[y,z],x] + [[z,x],y]$ is the Jacobiator.

The ternary Sabinin operation is:
$$\Phi(a,b,c) = [a,b,c] = (ab)c - a(bc)$$
and all higher operations vanish by alternativity.

### 9.6.2 Tree Monomials in the Octonionic Enveloping Algebra

For $U(\mathfrak{m})$ where $\mathfrak{m}$ is the Malcev algebra of $\operatorname{Im}(\mathbb{O})$, the tree PBW theorem gives a basis of tree monomials. Because the only non-trivial Sabinin operation beyond the bracket is the ternary associator, the tree-shape reduction is particularly tractable:

**Any** tree of weight $k$ can be reduced to one of $C_{k-1}$ standard trees, but the associator relation $(ab)c = a(bc) + [a,b,c]$ allows us to re-associate any tree, paying a "tax" of a single associator term (which has lower filtration degree).

**Example 9.14 (Weight 3).** Let $a, b, c \in \mathfrak{m}$ with $a < b < c$ in our ordering. The weight-3 monomials in $U(\mathfrak{m})$ are:

Standard tree monomials:
- $(e_a e_b) e_c$ — left-associated (standard tree 1)
- $e_a (e_b e_c)$ — right-associated (standard tree 2)

These are **both** basis elements. They are related by:
$$(e_a e_b) e_c = e_a (e_b e_c) + [e_a, e_b, e_c]$$

but $[e_a, e_b, e_c]$ is a weight-3 term that is *itself* a basis element (it reduces to a linear combination of weight-1 elements, since the associator of basis octonions is a single imaginary unit up to sign).

So the basis of $U(\mathfrak{m})$ at weight 3 with generators $e_a < e_b < e_c$ includes:
- $2 \cdot \binom{9}{3} = 168$ tree monomials with three distinct generators (where 9 = $\dim \operatorname{Im}(\mathbb{O}) + 2$ possible repeated indices... but let us be precise).

For $\operatorname{Im}(\mathbb{O})$ with basis $\{e_1, \ldots, e_7\}$, the weight-3 standard tree monomials with weakly increasing labels $i \leq j \leq k$ number:
$$2 \times \binom{7 + 3 - 1}{3} = 2 \times \binom{9}{3} = 2 \times 84 = 168.$$

Compare with the classical (associative) case: there would be only $\binom{9}{3} = 84$ ordered monomials. The non-associative PBW basis is **twice as large** at weight 3, reflecting the two distinct tree shapes.

### 9.6.3 Growth Rate

The dimension of the weight-$k$ component of $U(\mathfrak{m})$ is:
$$\dim(U(\mathfrak{m})_k) = C_{k-1} \cdot \binom{n + k - 1}{k}$$
where $n = 7$ and $C_{k-1}$ is the $(k-1)$-th Catalan number.

Since $C_{k-1} \sim \frac{4^{k-1}}{\sqrt{\pi} (k-1)^{3/2}}$, the non-associative enveloping algebra grows **exponentially faster** than the classical one. This is not a defect—it reflects the exponentially richer structure encoded by non-associativity. Each tree shape represents a distinct *context* for composing elements.

---

## 9.7 Alternative Approaches: Operadic PBW

### 9.7.1 The Operadic Perspective

The PBW theorem can be reformulated in the language of operads. An *operad* $\mathcal{P}$ encodes a type of algebra; the classical PBW theorem says that the operad $\mathcal{L}ie$ (encoding Lie algebras) and the operad $\mathcal{C}om$ (encoding commutative algebras) are *Koszul dual*, and the PBW theorem is a manifestation of Koszul duality at the level of algebras.

**Theorem 9.15 (Operadic PBW — Loday, Vallette).** Let $\mathcal{P}$ be a Koszul operad and $\mathcal{P}^!$ its Koszul dual. Then for any $\mathcal{P}^!$-algebra $A$, the universal enveloping $\mathcal{P}$-algebra $U_{\mathcal{P}}(A)$ has an explicit basis described by the bar construction $B(\mathcal{P}) \otimes_{\mathcal{P}^!} A$.

For the non-associative case, the relevant operad is not $\mathcal{A}ss$ (associative) but $\mathcal{M}ag$ (the magmatic operad, encoding algebras with a single binary operation and no axioms). Its Koszul dual is $\mathcal{M}ag^! = \mathcal{M}ag$ itself (it is self-dual). The PBW theorem for $\mathcal{M}ag$-algebras is trivial (the free $\mathcal{M}ag$-algebra is already the tree algebra).

The interesting case is the *alternative operad* $\mathcal{A}lt$, encoding alternative algebras (satisfying $(xx)y = x(xy)$ and $(xy)y = x(yy)$). The Koszul dual of $\mathcal{A}lt$ is related to the Malcev operad, and the PBW theorem for this pair gives precisely the tree-monomial basis of Theorem 9.12 when restricted to the octonionic case.

### 9.7.2 Relationship to Chapter 14

The full operadic treatment, including operads with uncountable arity and the passage from finite trees to measure-theoretic "continuous trees," is developed in Chapter 14. The present chapter establishes the finite-arity foundations.

---

## 9.8 The Reordering Algorithm

We provide an explicit algorithm for expressing any element of $U(S)$ in the tree PBW basis.

**Algorithm 9.16 (Tree PBW Reduction).**

*Input:* A tree monomial $T(x_{j_1}, \ldots, x_{j_k})$ in $U(S)$ (arbitrary tree shape, arbitrary leaf ordering).

*Output:* A linear combination of standard tree monomials.

1. **Label sorting.** For each pair of adjacent leaves in $T$ labeled $x_j, x_i$ with $j > i$:
   - Apply the commutator relation to swap: $\ldots x_j \cdot x_i \ldots \mapsto \ldots x_i \cdot x_j \ldots + \ldots [x_j, x_i] \ldots$
   - The correction term $[x_j, x_i] \in S$ has weight 1; it replaces the two leaves with a single leaf, reducing the total weight. Recurse on the correction term.
   - Continue until all labels are weakly increasing.

2. **Tree standardization.** Compare the tree shape $T$ with the set of standard trees $\mathcal{T}_k^{\text{std}}$:
   - If $T$ is already standard, done.
   - If not, find a subtree of the form $(ab)c$ or $a(bc)$ that differs from the standard form, and apply the associator relation:
     $$(ab)c = a(bc) + [a,b,c]$$
     or its inverse. The correction $[a,b,c]$ is a Sabinin operation evaluated on the subtree contents.
   - Recurse on the correction term.

3. **Termination.** Each step either reduces the weight (label sorting) or changes the tree toward standard form while generating lower-weight corrections. Since weight is bounded below by 0, the algorithm terminates.

**Complexity.** The worst case requires $O(k^2)$ commutator swaps (bubble sort) and $O(k)$ associator applications per weight level, giving total complexity $O(k^3)$ for a single monomial of weight $k$.

---

## 9.9 Worked Example: Full PBW Reduction in $U(\operatorname{Im}(\mathbb{O}))$

Let us carry out a complete reduction. Take the element $e_3 (e_1 e_2) \in U(\mathfrak{m})$ where $\mathfrak{m} = \operatorname{Im}(\mathbb{O})$.

**Step 1: Sort labels.** The leaf sequence is $(3, 1, 2)$. We need to sort to weakly increasing order.

The tree structure is $e_3 \cdot (e_1 \cdot e_2)$, which is right-associated: $R(e_3, e_1, e_2)$.

First, swap $e_3$ and $e_1$. But they are not adjacent in the tree in a simple sense—$e_3$ is the left child of the root, and $e_1$ is the left child of the right subtree. We must first re-associate to make them adjacent:

$$e_3 (e_1 e_2) = (e_3 e_1) e_2 - [e_3, e_1, e_2]$$

Now $(e_3 e_1) e_2$ is left-associated with leaf sequence $(3, 1, 2)$.

**Step 2: Swap $e_3$ and $e_1$ in $(e_3 e_1)$:**
$$(e_3 e_1) e_2 = (e_1 e_3 + [e_3, e_1]) e_2 = (e_1 e_3) e_2 + [e_3, e_1] e_2$$

Now $[e_3, e_1] = e_3 e_1 - e_1 e_3 = -e_5 - e_5 = -2e_5$ (using $e_1 e_3 = e_5$ from the Fano plane, so $e_3 e_1 = -e_5$, giving $[e_3, e_1] = -e_5 - e_5 = -2e_5$).

So: $(e_1 e_3) e_2 + (-2e_5) e_2 = (e_1 e_3) e_2 - 2 e_5 e_2$.

**Step 3: Now handle $(e_1 e_3) e_2$.** Leaf sequence is $(1, 3, 2)$. Need to swap $e_3$ and $e_2$:

$(e_1 e_3) e_2$: we must swap $e_3$ and $e_2$. They are in positions 2 and 3. Re-associate:
$$(e_1 e_3) e_2 = e_1 (e_3 e_2) + [e_1, e_3, e_2]$$
$$= e_1 (e_2 e_3 + [e_3, e_2]) + [e_1, e_3, e_2]$$
$$= e_1 (e_2 e_3) + e_1 [e_3, e_2] + [e_1, e_3, e_2]$$

Using the canonical Fano convention from Chapter 2 (oriented lines $(1,2,3), (1,4,5), (2,4,6), (3,4,7), (1,7,6), (2,5,7), (3,6,5)$), we have $e_2 e_3 = e_1$, $e_3 e_1 = e_2$, $e_3 e_2 = -e_1$. Since $\{e_1, e_2, e_3\}$ is a quaternionic triple, all associators among them vanish. We choose indices that produce non-zero associators instead.

**Example:** Take $[e_1, e_2, e_4]$. The set $\{1,2,4\}$ does not lie on any Fano line, so we expect a nonzero associator.

From the Fano plane: $e_1 e_2 = e_3$ (from $(1,2,3)$), $e_2 e_4 = e_6$ (from $(2,4,6)$), and $e_1 e_6 = -e_7$ (from $(1,7,6)$: $e_1 e_7 = e_6$, so $e_1 e_6 = -e_7$).

Then: $(e_1 e_2) e_4 = e_3 e_4 = e_7$ (from $(3,4,7)$).

And: $e_1(e_2 e_4) = e_1 e_6 = -e_7$.

So $[e_1, e_2, e_4] = (e_1 e_2)e_4 - e_1(e_2 e_4) = e_7 - (-e_7) = 2e_7$.

This is nonzero, as expected for a non-Fano triple.

**Another example: $[e_1, e_2, e_5]$.** We have:
- $e_1 e_2 = e_3$, so $(e_1 e_2) e_5 = e_3 e_5$. From the Fano line $(3,6,5)$: $e_3 e_6 = e_5$, so $e_3 e_5 = -e_6$ (reversing the line).
- $e_2 e_5 = e_7$ (from line $(2,5,7)$). So $e_1 (e_2 e_5) = e_1 e_7 = e_6$ (from line $(1,7,6)$: $e_1 e_7 = e_6$).

Then $[e_1, e_2, e_5] = (e_1 e_2)e_5 - e_1(e_2 e_5) = -e_6 - e_6 = -2e_6$.

This is also nonzero: the set $\{1,2,5\}$ does not lie on any Fano line.

**A third example: $[e_4, e_2, e_5]$.** We compute:
- $(e_4 e_2) e_5$: $e_4 e_2 = -e_6$ (from $(2,4,6)$: $e_2 e_4 = e_6$, so $e_4 e_2 = -e_6$). Then $(-e_6) e_5 = -e_6 e_5$. From $(3,6,5)$: $e_6 e_5 = e_3$. So $(e_4 e_2) e_5 = -e_3$.
- $e_4 (e_2 e_5)$: $e_2 e_5 = e_7$ (from $(2,5,7)$). $e_4 e_7 = e_3$ (from $(3,4,7)$: cyclic gives $e_4 e_7 = e_3$). So $e_4(e_2 e_5) = e_3$.

Thus $[e_4, e_2, e_5] = -e_3 - e_3 = -2e_3$.

The full PBW reduction of $e_4(e_2 e_5)$ proceeds:
$$e_4(e_2 e_5) = (e_4 e_2)e_5 - [e_4, e_2, e_5] = (e_4 e_2)e_5 + 2e_3$$

Then sorting $(e_4 e_2) e_5$: swap $e_4, e_2$:
$$(e_4 e_2)e_5 = (e_2 e_4 + [e_4, e_2])e_5 = (e_2 e_4)e_5 + [e_4, e_2] \cdot e_5$$
$$= (e_2 e_4)e_5 + (-2e_6)e_5 = (e_2 e_4)e_5 - 2(e_6 e_5) = (e_2 e_4)e_5 - 2e_3$$

(since $e_6 e_5 = e_3$ from the Fano triple $(3,6,5)$). Now $(e_2 e_4) e_5$ is left-associated with sorted labels $2 \leq 4 \leq 5$ — this is a standard tree monomial (left-comb, sorted labels).

Collecting: $e_4(e_2 e_5) = (e_2 e_4)e_5 - 2e_3 + 2e_3 = (e_2 e_4) e_5$.

This expresses the non-standard element as a standard tree monomial plus lower-weight corrections. This is the non-associative PBW theorem in action.

---

## 9.10 Uniqueness and Canonical Choices

### 9.10.1 Choice of Standard Trees

The set of standard trees $\mathcal{T}_k^{\text{std}}$ is not unique. Two natural choices are:

1. **Left combs** (maximally left-associated): $(((\cdots)x_{i_{k-1}})x_{i_k})$. This is the classical choice when restricted to the associative setting.

2. **Right combs** (maximally right-associated): $(x_{i_1}(\cdots(x_{i_{k-1}} x_{i_k})))$.

3. **All trees** (the maximal choice): take $\mathcal{T}_k^{\text{std}} = \mathcal{T}_k$. This gives the largest basis but is redundant for computation—it is the basis before any associator reduction.

For the octonionic framework, we adopt the convention of **left combs as primary**, with all other tree shapes expressed in terms of left combs plus associator corrections:
$$T(x_{i_1}, \ldots, x_{i_k}) = L(x_{i_1}, \ldots, x_{i_k}) + \text{lower-weight associator terms}$$
where $L$ denotes the left comb.

**Theorem 9.17 (Left-comb PBW for Malcev algebras).** For a Malcev algebra $\mathfrak{m}$ (and in particular for $\operatorname{Im}(\mathbb{O})$), the left-comb tree monomials with weakly increasing labels form a basis for $U(\mathfrak{m})$.

*Proof.* The proof proceeds in two parts: spanning (every element reduces to a linear combination of left-comb monomials with sorted labels) and linear independence.

**Part I: Spanning.** We prove by strong induction on $k$ (the weight of a tree monomial) that every tree monomial of weight $k$ can be written as an $\mathbb{R}$-linear combination of left-comb tree monomials with weakly increasing labels.

**Base cases.** For $k = 1$: every tree monomial is a single generator $x_i$, which is already a left comb (trivially) with sorted labels. For $k = 2$: every tree monomial is $x_i \cdot x_j$ (there is only one tree shape at weight 2). If $i \leq j$, it is already a left comb with sorted labels. If $i > j$, apply the Sabinin swap: $x_i \cdot x_j = x_j \cdot x_i + [x_i, x_j]$. The first term is a left comb with sorted labels; the correction $[x_i, x_j]$ is a single element of $\mathfrak{m}$ (weight 1), which is handled by the $k = 1$ base case.

**Inductive step.** Let $k \geq 3$ and assume the statement holds for all weights $< k$. Let $T(x_{j_1}, \ldots, x_{j_k})$ be an arbitrary tree monomial of weight $k$.

*Step A: Tree standardization to left comb.* We reduce the tree shape to a left comb by repeatedly applying the associator relation. For any Malcev algebra, the only non-trivial Sabinin operation beyond the binary bracket is the ternary associator $[a, b, c] = (ab)c - a(bc)$, and all higher Sabinin operations vanish. This is because the Malcev identity constrains the structure so that fourth-order and higher obstructions are expressible in terms of nested commutators and ternary associators (Kuzmin, E. N., "Malcev algebras and their representations," *Algebra i Logika* 7, 1968, Theorem 2).

Given any tree $T$ of weight $k$, identify the rightmost non-left-comb subtree — that is, the deepest internal node whose right child is itself an internal node (forming a pattern $a(bc)$ rather than $(ab)c$). Apply the associator relation:
$$a(bc) = (ab)c - [a, b, c].$$

The first term $(ab)c$ has the same weight $k$ but a strictly more "left-combed" tree shape (the right-branching depth at the identified node decreases by 1). The correction $[a, b, c]$ has weight $\leq k - 2$: since $\mathfrak{m}$ is the Malcev algebra of $\operatorname{Im}(\mathbb{O})$, the associator of three elements is an element of $\operatorname{Im}(\mathbb{O})$, i.e., it has weight 1 when $a, b, c$ are generators. More generally, if $a$ is a tree monomial of weight $p$ and $bc$ is a tree monomial of weight $q$ (with $p + q = k$), the associator $[a, b, c]$ decomposes via multilinearity into terms where each involves the ternary associator of three generators (weight 1) multiplied by the remaining tree monomial of weight $k - 3$, giving total weight $\leq k - 2$.

Define the *right-branching measure* $\mathrm{rb}(T)$ as the number of internal nodes whose right child is an internal node. Each application of the associator relation decreases $\mathrm{rb}(T)$ by 1 for the leading term while introducing corrections of weight $\leq k - 2$. A left comb has $\mathrm{rb} = 0$. Therefore, after at most $\mathrm{rb}(T) \leq k - 2$ applications, the leading term is a left comb of weight $k$, and all correction terms have weight $\leq k - 2 < k$ and are handled by the inductive hypothesis.

*Step B: Label sorting.* We now have a left-comb tree monomial $L_k(x_{j_1}, \ldots, x_{j_k}) = ((\cdots(x_{j_1} x_{j_2}) x_{j_3}) \cdots) x_{j_k}$ with possibly unsorted labels. We sort the labels by a non-associative bubble sort.

For each pair of adjacent leaves $x_{j_\ell}, x_{j_{\ell+1}}$ with $j_\ell > j_{\ell+1}$ in the left-comb structure, we swap using the commutator relation. The swap at position $\ell$ in the left comb requires first isolating the pair, which may involve a re-association. Consider the subtree at depth $\ell$: the left comb has the form $(\cdots(x_{j_\ell} x_{j_{\ell+1}}) \cdots)$. Applying the swap:
$$x_{j_\ell} x_{j_{\ell+1}} = x_{j_{\ell+1}} x_{j_\ell} + [x_{j_\ell}, x_{j_{\ell+1}}].$$

The first term has one fewer inversion while maintaining the left-comb structure. The correction $[x_{j_\ell}, x_{j_{\ell+1}}]$ is a single element of $\mathfrak{m}$ (weight 1), which replaces two leaves by one, yielding a left-comb monomial of weight $k - 1$. By the inductive hypothesis, this weight-$(k-1)$ term can be expressed in the desired form.

Iterating through all inversions (at most $\binom{k}{2}$ swaps, each producing a correction of weight $k - 1$, which is handled inductively), we reach a left-comb monomial with sorted labels $i_1 \leq i_2 \leq \cdots \leq i_k$, plus a finite linear combination of terms all of weight $< k$ that are handled by the inductive hypothesis.

This completes the spanning argument.

**Part II: Linear independence.** We appeal to the diamond lemma (Theorem 9.12, Stage 2, proved above). The rewriting system consisting of Rules (S) and (A) — specialized to the Malcev case where Rule (A) always converts to left-comb form — is terminating (the measure $\rho$ is well-ordered) and confluent (all critical pairs resolve, as verified in the Stage 2 proof). By the Bergman diamond lemma, the irreducible elements form a basis. In the Malcev specialization, the irreducible elements are precisely the left-comb tree monomials with weakly increasing labels: they are irreducible under Rule (S) because the labels are sorted, and under Rule (A) because the tree shape is already a left comb. $\square$

**Corollary 9.18.** When the Malcev algebra is actually a Lie algebra (i.e., when all associators vanish), Theorem 9.17 reduces to the classical PBW theorem, since the left comb is the unique tree shape and associator corrections vanish. This is the 3D recovery: restricting to the quaternionic subalgebra $\operatorname{Im}(\mathbb{H}) \subset \operatorname{Im}(\mathbb{O})$ yields a Lie algebra, and Theorem 9.17 becomes classical PBW.

---

## 9.11 The Filtration and Its Weight Structure

### 9.11.1 Weight Filtration

Define $F_k U(S) = \text{span of tree monomials of weight} \leq k$. This is a filtration:
$$F_0 \subset F_1 \subset F_2 \subset \cdots, \qquad \bigcup_k F_k = U(S).$$

**Proposition 9.19.** For any tree shapes $T_1 \in \mathcal{T}_p$, $T_2 \in \mathcal{T}_q$:
$$F_p \cdot F_q \subseteq F_{p+q}$$
where the product on the left is computed in *any* parenthesization (i.e., using any tree to combine the two factors).

*Proof.* The product of a weight-$p$ and weight-$q$ tree monomial is a tree monomial of weight $p + q$ (the resulting tree has $p + q$ leaves). Reduction to standard form only introduces corrections of *lower* weight. $\square$

### 9.11.2 Associated Graded

The associated graded $\operatorname{gr}(U(S)) = \bigoplus_k F_k / F_{k-1}$ is a commutative alternative algebra when $S$ is the Malcev algebra of $\operatorname{Im}(\mathbb{O})$. In the associated graded:
- Commutator corrections vanish (they have lower filtration degree).
- Associator corrections vanish (they have lower filtration degree).
- What remains is the free commutative alternative algebra on $S$.

This is the non-associative analog of $\operatorname{gr}(U(\mathfrak{g})) \cong \operatorname{Sym}(\mathfrak{g})$.

---

## 9.12 Connections to Other Chapters

- **Chapter 10** builds on this chapter to construct $U_{\mathbb{O}}(A)$ for algebras $A$ over the octonions, incorporating the decompactified Killing form and the COPBW theorem.
- **Chapter 14** extends the tree-monomial basis to uncountable arity using measure-theoretic operads.
- **Chapter 15** proves that restricting to $\operatorname{Im}(\mathbb{H}) \subset \operatorname{Im}(\mathbb{O})$ recovers classical PBW exactly.
- **Chapter 22** provides the complete existence and uniqueness proof for COPBW.

---

## 9.13 Summary of Main Results

1. **Classical PBW fails for non-associative algebras** at three points: reordering, linear independence, and filtration compatibility (Section 9.2).

2. **Akivis algebras** (Section 9.3.1) generalize Lie algebras by incorporating the associator as a ternary operation. **Sabinin algebras** (Section 9.3.2) provide the complete generalization to all arities.

3. **Tree monomials** (Section 9.4) replace ordered monomials. They are indexed by planar rooted binary trees, and their count at weight $k$ is multiplied by the Catalan number $C_{k-1}$.

4. **The non-associative PBW theorem** (Theorem 9.12) states that the universal enveloping algebra of a Sabinin algebra has a basis of standard tree monomials with sorted labels.

5. **For the octonions** (Section 9.6), the Malcev algebra structure ensures that left-comb tree monomials suffice as a basis, with the ternary associator providing all correction terms.

6. **The filtration** (Section 9.11) works analogously to the classical case, with the associated graded being a commutative alternative algebra rather than a symmetric algebra.

---

*Next: Chapter 10 constructs the full Contextual Octonionic Universal Enveloping Algebra $U_{\mathbb{O}}(A)$ and proves the COPBW theorem.*
